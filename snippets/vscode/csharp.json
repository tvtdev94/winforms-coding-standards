{
  "MVP Form with View Interface": {
    "prefix": "mvpform",
    "body": [
      "/// <summary>",
      "/// View interface for ${1:Customer} form following MVP pattern.",
      "/// </summary>",
      "public interface I${1:Customer}View",
      "{",
      "    // Events",
      "    event EventHandler? LoadRequested;",
      "    event EventHandler? SaveRequested;",
      "    event EventHandler? CancelRequested;",
      "",
      "    // Properties",
      "    bool IsLoading { get; set; }",
      "",
      "    // Methods",
      "    void ShowError(string message);",
      "    void ShowSuccess(string message);",
      "    void CloseView();",
      "}",
      "",
      "/// <summary>",
      "/// ${1:Customer} form implementing MVP pattern.",
      "/// </summary>",
      "public partial class ${1:Customer}Form : Form, I${1:Customer}View",
      "{",
      "    private readonly ${1:Customer}Presenter _presenter;",
      "",
      "    #region IView Events",
      "",
      "    public event EventHandler? LoadRequested;",
      "    public event EventHandler? SaveRequested;",
      "    public event EventHandler? CancelRequested;",
      "",
      "    #endregion",
      "",
      "    #region IView Properties",
      "",
      "    public bool IsLoading",
      "    {",
      "        get => !btnSave.Enabled;",
      "        set",
      "        {",
      "            btnSave.Enabled = !value;",
      "            btnCancel.Enabled = !value;",
      "            Cursor = value ? Cursors.WaitCursor : Cursors.Default;",
      "        }",
      "    }",
      "",
      "    #endregion",
      "",
      "    public ${1:Customer}Form(${1:Customer}Presenter presenter)",
      "    {",
      "        InitializeComponent();",
      "        _presenter = presenter ?? throw new ArgumentNullException(nameof(presenter));",
      "",
      "        // Wire UI events to View events",
      "        Load += (s, e) => LoadRequested?.Invoke(this, EventArgs.Empty);",
      "        btnSave.Click += (s, e) => SaveRequested?.Invoke(this, EventArgs.Empty);",
      "        btnCancel.Click += (s, e) => CancelRequested?.Invoke(this, EventArgs.Empty);",
      "    }",
      "",
      "    #region IView Methods",
      "",
      "    public void ShowError(string message)",
      "    {",
      "        MessageBox.Show(message, \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);",
      "    }",
      "",
      "    public void ShowSuccess(string message)",
      "    {",
      "        MessageBox.Show(message, \"Success\", MessageBoxButtons.OK, MessageBoxIcon.Information);",
      "    }",
      "",
      "    public void CloseView()",
      "    {",
      "        Close();",
      "    }",
      "",
      "    #endregion",
      "",
      "    protected override void Dispose(bool disposing)",
      "    {",
      "        if (disposing)",
      "        {",
      "            _presenter?.DetachView();",
      "            components?.Dispose();",
      "        }",
      "        base.Dispose(disposing);",
      "    }",
      "}",
      "$0"
    ],
    "description": "Create MVP pattern form with View interface"
  },

  "MVP Presenter": {
    "prefix": "mvppresenter",
    "body": [
      "/// <summary>",
      "/// Presenter for ${1:Customer} view, handling business logic and view coordination.",
      "/// </summary>",
      "public class ${1:Customer}Presenter",
      "{",
      "    private I${1:Customer}View? _view;",
      "    private readonly I${2:Customer}Service _service;",
      "    private readonly ILogger<${1:Customer}Presenter> _logger;",
      "",
      "    public ${1:Customer}Presenter(",
      "        I${1:Customer}View view,",
      "        I${2:Customer}Service service,",
      "        ILogger<${1:Customer}Presenter> logger)",
      "    {",
      "        _view = view ?? throw new ArgumentNullException(nameof(view));",
      "        _service = service ?? throw new ArgumentNullException(nameof(service));",
      "        _logger = logger ?? throw new ArgumentNullException(nameof(logger));",
      "",
      "        AttachView();",
      "    }",
      "",
      "    private void AttachView()",
      "    {",
      "        if (_view != null)",
      "        {",
      "            _view.LoadRequested += OnLoadRequested;",
      "            _view.SaveRequested += OnSaveRequested;",
      "            _view.CancelRequested += OnCancelRequested;",
      "        }",
      "    }",
      "",
      "    public void DetachView()",
      "    {",
      "        if (_view != null)",
      "        {",
      "            _view.LoadRequested -= OnLoadRequested;",
      "            _view.SaveRequested -= OnSaveRequested;",
      "            _view.CancelRequested -= OnCancelRequested;",
      "            _view = null;",
      "        }",
      "    }",
      "",
      "    private async void OnLoadRequested(object? sender, EventArgs e)",
      "    {",
      "        if (_view == null) return;",
      "",
      "        try",
      "        {",
      "            _view.IsLoading = true;",
      "            _logger.LogInformation(\"Loading data...\");",
      "",
      "            // TODO: Implement load logic",
      "            $0",
      "        }",
      "        catch (Exception ex)",
      "        {",
      "            _logger.LogError(ex, \"Error loading data\");",
      "            _view.ShowError($\"Failed to load: {ex.Message}\");",
      "        }",
      "        finally",
      "        {",
      "            _view.IsLoading = false;",
      "        }",
      "    }",
      "",
      "    private async void OnSaveRequested(object? sender, EventArgs e)",
      "    {",
      "        if (_view == null) return;",
      "",
      "        try",
      "        {",
      "            _view.IsLoading = true;",
      "            _logger.LogInformation(\"Saving data...\");",
      "",
      "            // TODO: Validate and save",
      "            _view.ShowSuccess(\"Saved successfully\");",
      "        }",
      "        catch (Exception ex)",
      "        {",
      "            _logger.LogError(ex, \"Error saving data\");",
      "            _view.ShowError($\"Failed to save: {ex.Message}\");",
      "        }",
      "        finally",
      "        {",
      "            _view.IsLoading = false;",
      "        }",
      "    }",
      "",
      "    private void OnCancelRequested(object? sender, EventArgs e)",
      "    {",
      "        _logger.LogInformation(\"Operation cancelled\");",
      "        _view?.CloseView();",
      "    }",
      "}"
    ],
    "description": "Create MVP presenter with view and service dependencies"
  },

  "Service Class with DI": {
    "prefix": "mvpservice",
    "body": [
      "/// <summary>",
      "/// Service interface for ${1:Customer} business logic.",
      "/// </summary>",
      "public interface I${1:Customer}Service",
      "{",
      "    Task<List<${1:Customer}>> GetAllAsync(CancellationToken ct = default);",
      "    Task<${1:Customer}?> GetByIdAsync(int id, CancellationToken ct = default);",
      "    Task<${1:Customer}> CreateAsync(${1:Customer} entity, CancellationToken ct = default);",
      "    Task UpdateAsync(${1:Customer} entity, CancellationToken ct = default);",
      "    Task DeleteAsync(int id, CancellationToken ct = default);",
      "}",
      "",
      "/// <summary>",
      "/// Service implementation for ${1:Customer} business logic.",
      "/// </summary>",
      "public class ${1:Customer}Service : I${1:Customer}Service",
      "{",
      "    private readonly I${1:Customer}Repository _repository;",
      "    private readonly ILogger<${1:Customer}Service> _logger;",
      "",
      "    public ${1:Customer}Service(",
      "        I${1:Customer}Repository repository,",
      "        ILogger<${1:Customer}Service> logger)",
      "    {",
      "        _repository = repository ?? throw new ArgumentNullException(nameof(repository));",
      "        _logger = logger ?? throw new ArgumentNullException(nameof(logger));",
      "    }",
      "",
      "    public async Task<List<${1:Customer}>> GetAllAsync(CancellationToken ct = default)",
      "    {",
      "        try",
      "        {",
      "            _logger.LogInformation(\"Retrieving all ${1:Customer} entities\");",
      "            var result = await _repository.GetAllAsync(ct);",
      "            _logger.LogInformation(\"Retrieved {Count} ${1:Customer} entities\", result.Count);",
      "            return result;",
      "        }",
      "        catch (Exception ex)",
      "        {",
      "            _logger.LogError(ex, \"Error retrieving ${1:Customer} entities\");",
      "            throw new InvalidOperationException(\"Failed to retrieve ${1:Customer} entities\", ex);",
      "        }",
      "    }",
      "",
      "    public async Task<${1:Customer}?> GetByIdAsync(int id, CancellationToken ct = default)",
      "    {",
      "        if (id <= 0)",
      "            throw new ArgumentException(\"ID must be greater than 0\", nameof(id));",
      "",
      "        try",
      "        {",
      "            _logger.LogInformation(\"Retrieving ${1:Customer} with ID {Id}\", id);",
      "            return await _repository.GetByIdAsync(id, ct);",
      "        }",
      "        catch (Exception ex)",
      "        {",
      "            _logger.LogError(ex, \"Error retrieving ${1:Customer} with ID {Id}\", id);",
      "            throw new InvalidOperationException($\"Failed to retrieve ${1:Customer} with ID {id}\", ex);",
      "        }",
      "    }",
      "",
      "    public async Task<${1:Customer}> CreateAsync(${1:Customer} entity, CancellationToken ct = default)",
      "    {",
      "        if (entity == null)",
      "            throw new ArgumentNullException(nameof(entity));",
      "",
      "        try",
      "        {",
      "            _logger.LogInformation(\"Creating new ${1:Customer}\");",
      "",
      "            // TODO: Add business validation here",
      "            $0",
      "",
      "            var result = await _repository.AddAsync(entity, ct);",
      "            _logger.LogInformation(\"${1:Customer} created successfully with ID {Id}\", result.Id);",
      "            return result;",
      "        }",
      "        catch (Exception ex)",
      "        {",
      "            _logger.LogError(ex, \"Error creating ${1:Customer}\");",
      "            throw new InvalidOperationException(\"Failed to create ${1:Customer}\", ex);",
      "        }",
      "    }",
      "",
      "    public async Task UpdateAsync(${1:Customer} entity, CancellationToken ct = default)",
      "    {",
      "        if (entity == null)",
      "            throw new ArgumentNullException(nameof(entity));",
      "",
      "        try",
      "        {",
      "            _logger.LogInformation(\"Updating ${1:Customer} with ID {Id}\", entity.Id);",
      "            await _repository.UpdateAsync(entity, ct);",
      "            _logger.LogInformation(\"${1:Customer} updated successfully\");",
      "        }",
      "        catch (Exception ex)",
      "        {",
      "            _logger.LogError(ex, \"Error updating ${1:Customer} with ID {Id}\", entity.Id);",
      "            throw new InvalidOperationException($\"Failed to update ${1:Customer} with ID {entity.Id}\", ex);",
      "        }",
      "    }",
      "",
      "    public async Task DeleteAsync(int id, CancellationToken ct = default)",
      "    {",
      "        if (id <= 0)",
      "            throw new ArgumentException(\"ID must be greater than 0\", nameof(id));",
      "",
      "        try",
      "        {",
      "            _logger.LogInformation(\"Deleting ${1:Customer} with ID {Id}\", id);",
      "            var entity = await _repository.GetByIdAsync(id, ct);",
      "            if (entity == null)",
      "                throw new InvalidOperationException($\"${1:Customer} with ID {id} not found\");",
      "",
      "            await _repository.DeleteAsync(entity, ct);",
      "            _logger.LogInformation(\"${1:Customer} deleted successfully\");",
      "        }",
      "        catch (Exception ex)",
      "        {",
      "            _logger.LogError(ex, \"Error deleting ${1:Customer} with ID {Id}\", id);",
      "            throw new InvalidOperationException($\"Failed to delete ${1:Customer} with ID {id}\", ex);",
      "        }",
      "    }",
      "}"
    ],
    "description": "Create service class with dependency injection and async methods"
  },

  "Async Event Handler": {
    "prefix": "asyncevent",
    "body": [
      "private async void ${1:btn}${2:Load}_Click(object sender, EventArgs e)",
      "{",
      "    try",
      "    {",
      "        // Disable UI during operation",
      "        ${1:btn}${2:Load}.Enabled = false;",
      "        Cursor = Cursors.WaitCursor;",
      "",
      "        // TODO: Perform async operation",
      "        $0",
      "    }",
      "    catch (Exception ex)",
      "    {",
      "        _logger?.LogError(ex, \"${2:Load} operation failed\");",
      "        MessageBox.Show(",
      "            $\"Error during ${2:Load}: {ex.Message}\",",
      "            \"Error\",",
      "            MessageBoxButtons.OK,",
      "            MessageBoxIcon.Error);",
      "    }",
      "    finally",
      "    {",
      "        // Re-enable UI",
      "        ${1:btn}${2:Load}.Enabled = true;",
      "        Cursor = Cursors.Default;",
      "    }",
      "}"
    ],
    "description": "Create async event handler with proper error handling"
  },

  "Thread-Safe UI Update": {
    "prefix": "invokeui",
    "body": [
      "/// <summary>",
      "/// Updates UI in a thread-safe manner.",
      "/// </summary>",
      "private void ${1:UpdateStatus}(${2:string} ${3:message})",
      "{",
      "    if (InvokeRequired)",
      "    {",
      "        Invoke(new Action<${2:string}>(${1:UpdateStatus}), ${3:message});",
      "        return;",
      "    }",
      "",
      "    // Safe to update UI here",
      "    $0",
      "}"
    ],
    "description": "Create thread-safe UI update method"
  },

  "Repository Class": {
    "prefix": "mvprepo",
    "body": [
      "/// <summary>",
      "/// Repository interface for ${1:Customer} entity.",
      "/// </summary>",
      "public interface I${1:Customer}Repository : IRepository<${1:Customer}>",
      "{",
      "    // Add specific repository methods here",
      "}",
      "",
      "/// <summary>",
      "/// Repository implementation for ${1:Customer} entity.",
      "/// </summary>",
      "public class ${1:Customer}Repository : I${1:Customer}Repository",
      "{",
      "    private readonly AppDbContext _context;",
      "",
      "    public ${1:Customer}Repository(AppDbContext context)",
      "    {",
      "        _context = context ?? throw new ArgumentNullException(nameof(context));",
      "    }",
      "",
      "    public async Task<List<${1:Customer}>> GetAllAsync(CancellationToken ct = default)",
      "    {",
      "        return await _context.${1:Customer}s.ToListAsync(ct);",
      "    }",
      "",
      "    public async Task<${1:Customer}?> GetByIdAsync(int id, CancellationToken ct = default)",
      "    {",
      "        return await _context.${1:Customer}s.FindAsync(new object[] { id }, ct);",
      "    }",
      "",
      "    public async Task<${1:Customer}> AddAsync(${1:Customer} entity, CancellationToken ct = default)",
      "    {",
      "        _context.${1:Customer}s.Add(entity);",
      "        await _context.SaveChangesAsync(ct);",
      "        return entity;",
      "    }",
      "",
      "    public async Task UpdateAsync(${1:Customer} entity, CancellationToken ct = default)",
      "    {",
      "        _context.${1:Customer}s.Update(entity);",
      "        await _context.SaveChangesAsync(ct);",
      "    }",
      "",
      "    public async Task DeleteAsync(${1:Customer} entity, CancellationToken ct = default)",
      "    {",
      "        _context.${1:Customer}s.Remove(entity);",
      "        await _context.SaveChangesAsync(ct);",
      "    }",
      "}"
    ],
    "description": "Create repository class with EF Core"
  },

  "Unit Test Method": {
    "prefix": "mvptest",
    "body": [
      "[Fact]",
      "public async Task ${1:MethodName}_${2:Scenario}_${3:ExpectedResult}()",
      "{",
      "    // Arrange",
      "    $0",
      "",
      "    // Act",
      "",
      "",
      "    // Assert",
      "",
      "}"
    ],
    "description": "Create xUnit test method with Arrange-Act-Assert pattern"
  }
}
